<html>

<head>
	<title>SKYAND-HW04</title>
	<link rel="shortcut icon" href="http://m100.nthu.edu.tw/~s100071049/pics/iconDSno.ico" type="image/x-icon" >
	<link href="css/painter.css" rel="stylesheet">
</head>	

<body>

<table>
	<tr><font face="Segoe Script" size="6" align="center" color="FFFF99">Canvas　</font>
		<font face="Segoe Script" size="6" align="center" color="FFFF99">Painter</font><br><br></tr>
</table>


<canvas id="myCanvas" width="700" height="500" style="position:absolute;left:300px;top:80px"></canvas>

<!--負責筆的表單-->
<form class="pencilbox" name="npencil" align="center">
	<br>
	<input type="image" src="./pics/hw4/penBno.png" onClick="pencil();return false" onmouseover="src='./pics/hw4/pengreenBno.png'" onmouseout="src='./pics/hw4/penBno.png'"width="65"><br/>
	<font face="Segoe Script" size="3" color="FFFF99">color</font><br>
	<input type="color" name="penColor"><!--選擇筆顏色--><br/><br>
	<font face="Segoe Script" size="3" color="FFFF99">thickness</font><br>
	<input type="range" min="0" max="40" step="0.5" value="5" name="thickness"> <!--選擇筆粗細--><br/>
	<font face="Segoe Script" size="3" color="FFFF99">shape</font><br>
	<select name="shape">
        <option value="butt">平直筆觸</option>
        <option value="round" selected>圓形筆觸</option>
        <option value="square">方形筆觸</option>
    </select><br/>
</form>

<!--負責橡皮擦的表單-->
<form  class="eraserBox" name="neraser" align="center">
	<br>
	<input type="image" src="./pics/hw4/eraserBno.png" width="70" onClick="eraser();return false" onmouseover="src='./pics/hw4/eraserhoverBno.png'" onmouseout="src='./pics/hw4/eraserBno.png'" ><br/><br>
	<font face="Segoe Script" size="3" color="FFFF99">thickness</font><br>
	<input type="range" min="0" max="40" step="0.5" value="5" name="thickness"> <!--選擇橡皮擦粗細--><br/><br>
	<font face="Segoe Script" size="3" color="FFFF99">shape</font><br>
	<select name="shape">
        <option value="butt">平直橡皮擦</option>
        <option value="round" selected>圓形橡皮擦</option>
        <option value="square">方形橡皮擦</option>
    </select><br/>
</form>

<!--負責文字輸入的表單-->
<form  class="textInput" name="ntext" align="center">
	<br>
	<font face="Segoe Script" size="3" color="FFFF99">text input</font><br>
	<input type="text" id="word" placeholder="文字" size="17"/><br/>
	<input type="text" id="x" placeholder="x座標" size="10"/><br/>
	<input type="text" id="y" placeholder="y座標" size="10"/><br/>
	<input type="color" name="textColor"><!--選擇顏色--><br/><br/>
	<input type="button" name="inputText" value="print!" onClick="text(this.form.word.value,this.form.x.value,this.form.y.value)"/>
	
</form>

<!--負責其他功能的表單-->
<form class="others" name="nothers" align="center">
	
	<font face="Segoe Script" size="3" color="FFFF99">clear</font><br>
	<input type="image" src="./pics/hw4/garbageCno.png" onClick="clearCanvas();return false" onmouseover="src='./pics/hw4/garbageOno.png'" onmouseout="src='./pics/hw4/garbageCno.png'" width="68"><br/>
	<font face="Segoe Script" size="3" color="FFFF99">see your picture</font><br>
	<input type="image" src="./pics/hw4/outputBno.png" onClick="output();return false" onmouseover="src='./pics/hw4/outputoverBno.png'"  onmouseout="src='./pics/hw4/outputBno.png'" width="70"/>
</form>

 
<script>
var canvas = document.getElementById("myCanvas"); // 取得物件
var ctx = canvas.getContext("2d"); // 取得繪圖環境
var drawMode, mx, my;
var mode=1;//1 for pencil; 0 for eraser

//畫筆
function pencil(){
	canvas.style.cursor="url(./pics/hw4/penSno.png), auto";
	mode=1;
}
//橡皮擦
function eraser(){
	canvas.style.cursor="url(./pics/hw4/eraserSno.png), auto";
	mode=0;
   }
	
canvas.onmousedown = function(){
		
	ctx.beginPath();
	if(mode==1){
		ctx.strokeStyle = document.npencil.penColor.value;//從顏色選擇器取值
		ctx.lineWidth = document.npencil.thickness.value;
		ctx.lineCap = document.npencil.shape.value;
	}
	else if(mode==0){
		ctx.strokeStyle = "white";
		ctx.lineWidth = document.neraser.thickness.value;
		ctx.lineCap = document.neraser.shape.value;
	}
	ctx.moveTo(event.clientX - canvas.style.posLeft-310, event.clientY - canvas.style.posTop-70);
	drawMode = true;
	return false;//讓游標不要變成text
}
	
canvas.onmousemove = function(ev){
	if(drawMode){
		mx = event.clientX - parseInt(canvas.style.left) + window.pageXOffset;
		my = event.clientY - parseInt(canvas.style.top) + window.pageYOffset;
		ctx.lineTo(mx, my);
		ctx.stroke();
	}

}
canvas.onmouseup = function(){
	drawMode = false;
}
//輸出圖片
function output() {
	window.open(document.getElementById('myCanvas').toDataURL('img/png'));// or window.open(ctx.canvas.toDataURL('img/png'));
}

//輸入文字
function text(g,h,i){
	ctx.fillStyle = document.ntext.textColor.value;
	ctx.font = '30px Segoe Script';
	//ctx.textAlign = 'center';
	//ctx.strokeText(g,h,i);
	ctx.fillText(g,h,i);
}

//清空畫面
function clearCanvas(){
	ctx.clearRect(0, 0, canvas.width, canvas.height);
}
</script>
 
</body></html>